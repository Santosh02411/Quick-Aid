<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Aid - Medical Assistant</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
      
            
        
        function displayImageResults(result) {
            let html = '';
            
            if (result.error) {
                html = `<div class="emergency"><strong>Error:</strong> ${result.error}</div>`;
            } else {
                html += `<h3>Analysis Results</h3>`;
                
                if (result.analysis.detected_conditions) {
                    html += `<h4>Detected Conditions:</h4>`;
                    result.analysis.detected_conditions.forEach(condition => {
                        html += `<div class="condition">${condition}</div>`;
                    });
                }
                
                if (result.analysis.recommendations) {
                    html += `<h4>Recommendations:</h4>`;
                    result.analysis.recommendations.forEach(rec => {
                        html += `<div class="recommendation">${rec}</div>`;
                    });
                }
                
                if (result.analysis.safety_tips) {
                    html += `<h4>Safety Tips:</h4>`;
                    result.analysis.safety_tips.forEach(tip => {
                        html += `<div class="recommendation">${tip}</div>`;
                    });
                }
                
                html += `<div style="margin-top: 15px; font-size: 12px; color: #666;">${result.analysis.disclaimer}</div>`;
            }
            
            imageResults.innerHTML = html;
            imageResults.style.display = 'block';
        }
        
        // Symptom analysis
        checkSymptomsBtn.addEventListener('click', analyzeSymptoms);
        
        async function analyzeSymptoms() {
            const symptoms = symptomsInput.value.trim();
            if (!symptoms) {
                alert('Please describe your symptoms');
                return;
            }
            
            symptomLoading.style.display = 'block';
            symptomResults.style.display = 'none';
            
            try {
                const response = await fetch('/analyze_symptoms', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({symptoms: symptoms})
                });
                
                const result = await response.json();
                displaySymptomResults(result);
            } catch (error) {
                displaySymptomResults({error: 'Network error occurred'});
            }
            
            symptomLoading.style.display = 'none';
        }
        
        function displaySymptomResults(result) {
            let html = '';
            
            if (result.error) {
                html = `<div class="emergency"><strong>Error:</strong> ${result.error}</div>`;
            } else {
                const analysis = result.analysis;
                
                if (analysis.emergency_alert && analysis.emergency_alert.alert) {
                    html += `<div class="emergency"><strong>${analysis.emergency_alert.message}</strong><br>${analysis.emergency_alert.action}</div>`;
                }
                
                html += `<h3>Symptom Analysis</h3>`;
                
                if (analysis.detected_symptoms) {
                    html += `<h4>Detected Symptoms:</h4>`;
                    analysis.detected_symptoms.forEach(symptom => {
                        const symptomText = typeof symptom === 'string' ? symptom : (symptom.name || symptom.toString());
                        html += `<div class="condition">${symptomText.replace('_', ' ')}</div>`;
                    });
                }
                
                if (analysis.possible_conditions) {
                    html += `<h4>Possible Conditions:</h4>`;
                    analysis.possible_conditions.forEach(condition => {
                        const conditionText = typeof condition === 'string' ? condition : (condition.name || condition.toString());
                        html += `<div class="condition">${conditionText}</div>`;
                    });
                }
                
                if (analysis.recommendations) {
                    html += `<h4>Recommendations:</h4>`;
                    analysis.recommendations.forEach(rec => {
                        const className = rec.includes('ðŸš¨') ? 'emergency' : 'recommendation';
                        html += `<div class="${className}">${rec}</div>`;
                    });
                }
    </script>
</body>
</html>
